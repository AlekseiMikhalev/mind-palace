
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="My personal mind palace that summarizes my knowledge" name="description"/>
<meta content="Aleksei Mikhalev" name="author"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-8.5.10" name="generator"/>
<title>Testing - Developer Mind Palace</title>
<link href="../../assets/stylesheets/main.975780f9.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.2505c338.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#python-testing">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Developer Mind Palace" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Developer Mind Palace">
<img alt="logo" src="../../assets/images/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Developer Mind Palace
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Testing
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_3" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_3" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/AlekseiMikhalev/mind-palace" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Developer Mind Palace" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Developer Mind Palace">
<img alt="logo" src="../../assets/images/logo.png"/>
</a>
    Developer Mind Palace
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/AlekseiMikhalev/mind-palace" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Introduction
      </a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../projects/">Projects</a>
<label for="__nav_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Projects" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Projects
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../projects/book_summarizer/">
        Book Summarizer
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../projects/age_classification/">
        Age Classification
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../software_architecture/">Software Architecture</a>
<label for="__nav_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Software Architecture" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Software Architecture
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../software_architecture/architectural_patterns/mv_patterns/">
        Architectural Patterns
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2">
          Architectural Principles
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Architectural Principles" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
          Architectural Principles
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../software_architecture/clean_architecture.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../frontend/">Frontend</a>
<label for="__nav_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Frontend" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Frontend
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1">
          Create a website
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Create a website" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
          Create a website
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../create_website.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">Backend</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Backend" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Backend
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" id="__nav_5_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../efficient_programming/">Efficient Programming</a>
<label for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Efficient Programming" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
          Efficient Programming
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../concurrency_parallelism/">
        Concurrency and Parallelism
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../oop/">
        OOP
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Testing
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Testing
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#main-concepts-of-testing">
    Main Concepts of Testing
  </a>
<nav aria-label="Main Concepts of Testing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#test-strategy">
    Test Strategy
  </a>
<nav aria-label="Test Strategy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#determing-test-scope">
    Determing Test Scope
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#considering-software-architecture">
    Considering Software Architecture
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#evaluating-the-features-to-test">
    Evaluating the features to test
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-test-cases">
    Creating test cases
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#coverage">
    Coverage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#commands">
    Commands
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-naming-conventions">
    Test naming conventions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-exceptions">
    Test exceptions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#structuring-test-functions">
    Structuring test functions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pytest-fixtures">
    Pytest Fixtures
  </a>
<nav aria-label="Pytest Fixtures" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#builtin-fixtures">
    Builtin Fixtures
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#parametrization">
    Parametrization
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mocking">
    Mocking
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2">
          CI/CD Pipeline
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="CI/CD Pipeline" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
          CI/CD Pipeline
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ci_cd_pipeline.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" id="__nav_5_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3">
          Microservice
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Microservice" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
          Microservice
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../microservices.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" id="__nav_5_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_4">
          API Gateway
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="API Gateway" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
          API Gateway
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../gateway.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5" id="__nav_5_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_5">
          Data Center
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Data Center" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_5">
<span class="md-nav__icon md-icon"></span>
          Data Center
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../data_centers.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_6" id="__nav_5_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_6">
          Load Balancer
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Load Balancer" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_6">
<span class="md-nav__icon md-icon"></span>
          Load Balancer
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../load_balancer.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../message_broker/">
        Message Broker
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_8" id="__nav_5_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_8">
          Containers Orchestration
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Containers Orchestration" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_8">
<span class="md-nav__icon md-icon"></span>
          Containers Orchestration
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../containers_orchestration.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_9" id="__nav_5_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_9">
          Data Query and Manipulation
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Data Query and Manipulation" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_9">
<span class="md-nav__icon md-icon"></span>
          Data Query and Manipulation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../data_query.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_10" id="__nav_5_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_10">
          Database
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Database" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_10">
<span class="md-nav__icon md-icon"></span>
          Database
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../database.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_11" id="__nav_5_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_11">
          Storage for Large Files
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Storage for Large Files" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_11">
<span class="md-nav__icon md-icon"></span>
          Storage for Large Files
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../storage.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_12" id="__nav_5_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_12">
          Cache
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Cache" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_12">
<span class="md-nav__icon md-icon"></span>
          Cache
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../cache.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_13" id="__nav_5_13" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_13">
          Text Search
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Text Search" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_13">
<span class="md-nav__icon md-icon"></span>
          Text Search
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../text_search.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_14" id="__nav_5_14" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_14">
          Analytics
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Analytics" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_14">
<span class="md-nav__icon md-icon"></span>
          Analytics
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_15" id="__nav_5_15" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_15">
          Scheduller
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Scheduller" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_15">
<span class="md-nav__icon md-icon"></span>
          Scheduller
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../scheduller.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_16" id="__nav_5_16" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_16">
          Big Data
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Big Data" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_16">
<span class="md-nav__icon md-icon"></span>
          Big Data
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../big_data.md">
        None
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../machine_learning/">Machine Learning</a>
<label for="__nav_6">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Machine Learning" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Machine Learning
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../machine_learning/math/">
        Math
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" id="__nav_6_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../machine_learning/nlp/">NLP</a>
<label for="__nav_6_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="NLP" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_2">
<span class="md-nav__icon md-icon"></span>
          NLP
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../machine_learning/nlp/text_classification/">
        Text Classification
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../machine_learning/nlp/information_search/">
        Information Search
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../machine_learning/nlp/statistical_text_analysis/">
        Statistical Analysis of Text
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#main-concepts-of-testing">
    Main Concepts of Testing
  </a>
<nav aria-label="Main Concepts of Testing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#test-strategy">
    Test Strategy
  </a>
<nav aria-label="Test Strategy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#determing-test-scope">
    Determing Test Scope
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#considering-software-architecture">
    Considering Software Architecture
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#evaluating-the-features-to-test">
    Evaluating the features to test
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-test-cases">
    Creating test cases
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#coverage">
    Coverage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#commands">
    Commands
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-naming-conventions">
    Test naming conventions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-exceptions">
    Test exceptions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#structuring-test-functions">
    Structuring test functions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pytest-fixtures">
    Pytest Fixtures
  </a>
<nav aria-label="Pytest Fixtures" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#builtin-fixtures">
    Builtin Fixtures
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#parametrization">
    Parametrization
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mocking">
    Mocking
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/AlekseiMikhalev/mind-palace/edit/master/docs/backend/testing.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
</a>
<h1 id="python-testing">Python Testing</h1>
<p>Sources:</p>
<ul>
<li>
<p>Books:</p>
<ul>
<li><a href="https://pragprog.com/titles/bopytest2/python-testing-with-pytest-second-edition/">Python Testing with pytest, Second Edition</a></li>
</ul>
</li>
<li>
<p>Documentation:</p>
<ul>
<li><a href="https://docs.pytest.org/en/7.2.x/">pytest</a></li>
</ul>
</li>
</ul>
<h2 id="main-concepts-of-testing">Main Concepts of Testing</h2>
<h3 id="test-strategy">Test Strategy</h3>
<h4 id="determing-test-scope">Determing Test Scope</h4>
<p>We will almost always want to test the behavior of the user visible functionality. However, there are quite a few other questions we need to consider when determining how much testing we need to do:</p>
<ul>
<li>Is security a concern?</li>
<li>Performance? Do interactions need to be fast? How fast?</li>
<li>Loading? Can you handle lots of people with lots of requests? Are you expecting to need to? If so, you should test for that.</li>
<li>Input validation? For really any system that accepts input from users, we should validate the data before acting on it.</li>
</ul>
<p>Decide what features to test?</p>
<h4 id="considering-software-architecture">Considering Software Architecture</h4>
<ul>
<li>how your project’s software is organized</li>
<li>what APIs are available</li>
<li>what the interfaces are</li>
<li>where code complexity lives</li>
<li>modularity</li>
<li>etc.</li>
</ul>
<p>Another main factors that affect testing strategy:</p>
<ul>
<li>At what level should we be testing? The top user interface? Something lower? Subsystem? All levels?</li>
<li>How easy is it to test at different levels?</li>
<li>Who is responsible for the different levels and the testing of each? If you are supplying a subsystem, are you only responsible for that subsystem? Is someone else doing the system testing? If so, it’s an easy choice: test your own subsystem.</li>
</ul>
<h4 id="evaluating-the-features-to-test">Evaluating the features to test</h4>
<p>Prioritize features to test based on the following factors:</p>
<ul>
<li><em>Recent</em> — New features, new areas of code, new functionality that has been recently repaired, refactored, or otherwise modified</li>
<li><em>Core</em> — Your product’s unique selling propositions (USPs). The essential functions that must continue to work in order for the product to be useful</li>
<li><em>Risk</em> — Areas of the application that pose more risk, such as areas important to customers but not used regularly by the development team or parts that use third-party code you don’t quite trust</li>
<li><em>Problematic</em> — Functionality that frequently breaks or often gets defect reports against it</li>
<li><em>Expertise</em> — Features or algorithms understood by a limited subset of people</li>
</ul>
<h4 id="creating-test-cases">Creating test cases</h4>
<ul>
<li>Start with a non-trivial, “happy path” test case.</li>
<li>
<p>Then look at test cases that represent</p>
<ul>
<li>interesting sets of input,</li>
<li>interesting starting states,</li>
<li>interesting end states, or</li>
<li>all possible error states.</li>
</ul>
</li>
</ul>
<h3 id="coverage">Coverage</h3>
<p>Code coverage tool cannot tell you if your test suite is good; it can only tell you how much of the application code is getting hit by your test suite. But that in itself is useful information. </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">    $ </span>pip install coverage
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">    $ </span>pip install pytest-cov
</code></pre></div>
<h3 id="commands">Commands</h3>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>    pytest -v test_two.py <span class="c1">#(1)</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>    pytest --tb<span class="o">=</span>no <span class="c1">#(2)</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>    pytest --tb<span class="o">=</span>no test_one.py test_two.py <span class="c1">#(3)</span>
</code></pre></div>
<ol>
<li><code>-v</code> adds information if test fails and shows exactly the reason of failure</li>
<li>use <code>--tb=no</code> flag to rutn off tracebacks</li>
<li>indicate specific tests to run</li>
</ol>
<h3 id="test-naming-conventions">Test naming conventions</h3>
<ul>
<li>Test files should be named <code>test_&lt;something&gt;.py</code> or <code>&lt;something&gt;_test.py</code>.</li>
<li>Test methods and functions should be named <code>test_&lt;something&gt;</code>.</li>
<li>Test classes should be named <code>Test&lt;Something&gt;</code></li>
</ul>
<h3 id="test-exceptions">Test exceptions</h3>
<p>If we need to test expected exceptions we can use <code>pytest.raises()</code>:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>    <span class="kn">import</span> <span class="nn">pytest</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>    <span class="kn">import</span> <span class="nn">cards</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>    <span class="k">def</span> <span class="nf">test_no_path_raises</span><span class="p">():</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span> <span class="c1">#(1)</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>            <span class="n">cards</span><span class="o">.</span><span class="n">CardsDB</span><span class="p">()</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="k">def</span> <span class="nf">test_raises_with_info</span><span class="p">():</span> <span class="c1">#(2)</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>        <span class="n">match_regex</span> <span class="o">=</span> <span class="s2">"missing 1 .* positional argument"</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="n">match_regex</span><span class="p">):</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>            <span class="n">cards</span><span class="o">.</span><span class="n">CardsDB</span><span class="p">()</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a>    <span class="k">def</span> <span class="nf">test_raises_with_info_alt</span><span class="p">():</span>
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>            <span class="n">cards</span><span class="o">.</span><span class="n">CardsDB</span><span class="p">()</span>
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>        <span class="n">expected</span> <span class="o">=</span> <span class="s2">"missing 1 required positional argument"</span>
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>        <span class="k">assert</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
<ol>
<li>
<p>the <code>with pytest.raises(TypeError):</code> statement says that whatever is in the next block of code should raise a TypeError exception. If no exception is raised, the test fails. If the test raises a different exception, it fails.</p>
</li>
<li>
<p>check to make sure the message is correct, or any other aspect of the exception, like additional parameters</p>
</li>
</ol>
<h3 id="structuring-test-functions">Structuring test functions</h3>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>    <span class="k">def</span> <span class="nf">test_to_dict</span><span class="p">():</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>        <span class="c1"># GIVEN a Card object with known contents</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>        <span class="n">c1</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"something"</span><span class="p">,</span> <span class="s2">"brian"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span> <span class="c1">#(1)</span>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>        <span class="c1"># WHEN we call to_dict() on the object</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>        <span class="n">c2</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="c1">#(2)</span>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>        <span class="c1"># THEN the result will be a dictionary with known content</span>
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a>        <span class="n">c2_expected</span> <span class="o">=</span> <span class="p">{</span> 
<a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a>            <span class="s2">"summary"</span><span class="p">:</span> <span class="s2">"something"</span><span class="p">,</span>
<a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a>            <span class="s2">"owner"</span><span class="p">:</span> <span class="s2">"brian"</span><span class="p">,</span>
<a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>            <span class="s2">"state"</span><span class="p">:</span> <span class="s2">"todo"</span><span class="p">,</span>
<a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a>            <span class="s2">"id"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
<a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a>        <span class="p">}</span>
<a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a>        <span class="k">assert</span> <span class="n">c2</span> <span class="o">==</span> <span class="n">c2_expected</span> <span class="c1">#(3)</span>
</code></pre></div>
<ol>
<li>
<p>A starting state. This is where you set up data or the environment to get ready for the action.</p>
</li>
<li>
<p>Some action is performed. This is the focus of the test—the
behavior we are trying to make sure is working right.</p>
</li>
<li>
<p>Some expected result or end state should happen. At the end of the test, we make sure the action resulted in the expected behavior.</p>
</li>
</ol>
<p>Structure tests in classes:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>    <span class="k">class</span> <span class="nc">TestEquality</span><span class="p">:</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>        <span class="k">def</span> <span class="nf">test_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>            <span class="n">c1</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"something"</span><span class="p">,</span> <span class="s2">"brian"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>            <span class="n">c2</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"something"</span><span class="p">,</span> <span class="s2">"brian"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>            <span class="k">assert</span> <span class="n">c1</span> <span class="o">==</span> <span class="n">c2</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>        <span class="k">def</span> <span class="nf">test_equality_with_diff_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>            <span class="n">c1</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"something"</span><span class="p">,</span> <span class="s2">"brian"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>            <span class="n">c2</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"something"</span><span class="p">,</span> <span class="s2">"brian"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">,</span> <span class="mi">4567</span><span class="p">)</span>
<a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>            <span class="k">assert</span> <span class="n">c1</span> <span class="o">==</span> <span class="n">c2</span>
<a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a>
<a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a>        <span class="k">def</span> <span class="nf">test_inequality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a>            <span class="n">c1</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"something"</span><span class="p">,</span> <span class="s2">"brian"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a>            <span class="n">c2</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"completely different"</span><span class="p">,</span> <span class="s2">"okken"</span><span class="p">,</span> <span class="s2">"done"</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a>            <span class="k">assert</span> <span class="n">c1</span> <span class="o">!=</span> <span class="n">c2</span>
</code></pre></div>
<p>Running a single test method, test class, or module:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="gp">    $ </span>pytest ch2/test_classes.py::TestEquality::test_equality
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="gp">    $ </span>pytest ch2/test_classes.py::TestEquality
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="gp">    $ </span>pytest ch2/test_classes.py
</code></pre></div>
<p>Running a single test function or module:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="gp">    $ </span>pytest ch2/test_card.py::test_defaults
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="gp">    $ </span>pytest ch2/test_card.py
</code></pre></div>
<p>Running the whole directory:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="gp">    $ </span>pytest ch2
</code></pre></div>
<h3 id="pytest-fixtures">Pytest Fixtures</h3>
<p>Pytest treats exceptions differently during fixtures compared to during a test function. An exception (or assert failure or call to <code>pytest.fail()</code>) that happens during the test code proper results in a “Fail” result. However, during a fixture, the test function is reported as “Error.” This distinction is helpful when debugging why a test didn’t pass. If a test results in “Fail,” the failure is somewhere in the test function (or something the function called). If a test results in “Error,” the failure is somewhere in a fixture.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>    <span class="kn">import</span> <span class="nn">pytest</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">()</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>    <span class="k">def</span> <span class="nf">cards_db</span><span class="p">():</span> <span class="c1">#(1)</span>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>        <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">db_dir</span><span class="p">:</span>
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>            <span class="n">db_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">db_dir</span><span class="p">)</span>
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a>            <span class="n">db</span> <span class="o">=</span> <span class="n">cards</span><span class="o">.</span><span class="n">CardsDB</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a>            <span class="k">yield</span> <span class="n">db</span> <span class="c1">#(2)</span>
<a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>
<a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a>    <span class="k">def</span> <span class="nf">test_empty</span><span class="p">(</span><span class="n">cards_db</span><span class="p">):</span>
<a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a>        <span class="k">assert</span> <span class="n">cards_db</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a>
<a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a>    <span class="k">def</span> <span class="nf">test_two</span><span class="p">(</span><span class="n">cards_db</span><span class="p">):</span>
<a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a>        <span class="n">cards_db</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">cards</span><span class="o">.</span><span class="n">Card</span><span class="p">(</span><span class="s2">"first"</span><span class="p">))</span>
<a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a>        <span class="n">cards_db</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">cards</span><span class="o">.</span><span class="n">Card</span><span class="p">(</span><span class="s2">"second"</span><span class="p">))</span>
<a href="#__codelineno-8-17" id="__codelineno-8-17" name="__codelineno-8-17"></a>        <span class="k">assert</span> <span class="n">cards_db</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</code></pre></div>
<ol>
<li>
<p><code>cards_db</code> fixture is “setting up” for the test by getting the database ready. It is like a dependency, which is injected into the test function.</p>
</li>
<li>
<p>Fixture functions run before the tests that use them. If there is a <code>yield</code> in the function, it stops there, passes control to the tests, and picks up on the next line after the tests are done.</p>
</li>
</ol>
<p>The following command-line flag <code>--setup-show</code> shows us the order of operations of tests and fixtures:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="gp">    $ </span>pytest --setup-show test_count.py
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="go">    ======================== test session starts =========================</span>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="go">    collected 2 items</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="go">    test_count.py</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="go">        SETUP</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="go">        F cards_db</span>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="go">        ch3/test_count.py::test_empty (fixtures used: cards_db).</span>
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="go">        TEARDOWN F cards_db</span>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="go">        SETUP</span>
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="go">        F cards_db</span>
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="go">        ch3/test_count.py::test_two (fixtures used: cards_db).</span>
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="go">        TEARDOWN F cards_db</span>
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="go">    ========================= 2 passed in 0.02s ==========================</span>
</code></pre></div>
<p>Fixture scope:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">"module"</span><span class="p">)</span> <span class="c1">#(1)</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>    <span class="k">def</span> <span class="nf">cards_db</span><span class="p">():</span>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>        <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">db_dir</span><span class="p">:</span>
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>            <span class="n">db_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">db_dir</span><span class="p">)</span>
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>            <span class="n">db</span> <span class="o">=</span> <span class="n">cards</span><span class="o">.</span><span class="n">CardsDB</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span>
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>            <span class="k">yield</span> <span class="n">db</span>
<a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a>            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<ol>
<li><code>scope="module"</code> allows us to open database only once and use the result in the whole module</li>
</ol>
<p>Using <code>scope</code> allows us to run slow part of the test once for multiple tests:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="gp">    $ </span>pytest --setup-show test_mod_scope.py
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="go">    ========================== test session starts ==========================</span>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="go">    collected 2 items</span>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a>
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="go">    test_mod_scope.py</span>
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="go">        SETUP</span>
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="go">        M cards_db</span>
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="go">        ch3/test_mod_scope.py::test_empty (fixtures used: cards_db).</span>
<a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="go">        ch3/test_mod_scope.py::test_two (fixtures used: cards_db).</span>
<a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="go">        TEARDOWN M cards_db</span>
<a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="go">    =========================== 2 passed in 0.03s ===========================</span>
</code></pre></div>
<p><code>scope</code> options:</p>
<ul>
<li>
<p><code>scope='function'</code> - Run once per test function. The setup portion is run before each test using the fixture.</p>
</li>
<li>
<p><code>scope='class'</code> - Run once per test class, regardless of how many test methods are in the class.</p>
</li>
<li>
<p><code>scope='module'</code> - Run once per module, regardless of how many test functions or methods or other fixtures in the module use it.</p>
</li>
<li>
<p><code>scope='package'</code> - Run once per package, or test directory, regardless of how many test functions or methods or other fixtures in the package use it.</p>
</li>
<li>
<p><code>scope='session'</code> - Run once per session. All test methods and functions using a fixture of session scope share one setup and teardown call.</p>
</li>
</ul>
<p>The <code>conftest.py</code> file is considered by pytest as a “local plugin” and can contain hook functions and fixtures. Thus we can share fixtures among other tests. </p>
<p>Tests can use any fixture that is in the same test module as a test function, or in a <code>conftest.py</code> file in the same directory, or in any level of parent directory up to the root of the tests.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="gp">    $ </span>pytest --fixtures -v
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="go">    ...</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="go">    -------------------- fixtures defined from conftest ---------------------</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="go">    cards_db [session scope] -- conftest.py:7</span>
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="go">    CardsDB object connected to a temporary database</span>
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="go">    ...</span>
</code></pre></div>
<h4 id="builtin-fixtures">Builtin Fixtures</h4>
<p>The <code>tmp_path</code> and <code>tmp_path_factory</code> fixtures are used to create temporary directories. </p>
<p>The <code>tmp_path</code> function-scope fixture returns a <code>pathlib.Path</code> instance that points to a temporary directory that sticks around during your test and a bit longer. </p>
<p>The <code>tmp_path_factory</code> session-scope fixture returns a <code>TempPathFactory</code> object. This object has a <code>mktemp()</code> function that returns <code>Path</code> objects. We can use <code>mktemp()</code>to create multiple temporary directories.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>    <span class="k">def</span> <span class="nf">test_tmp_path</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">):</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">tmp_path</span> <span class="o">/</span> <span class="s2">"file.txt"</span>
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a>        <span class="n">file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">)</span>
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a>        <span class="k">assert</span> <span class="n">file</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Hello"</span>
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a>
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a>    <span class="k">def</span> <span class="nf">test_tmp_path_factory</span><span class="p">(</span><span class="n">tmp_path_factory</span><span class="p">):</span>
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">tmp_path_factory</span><span class="o">.</span><span class="n">mktemp</span><span class="p">(</span><span class="s2">"sub"</span><span class="p">)</span>
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s2">"file.txt"</span>
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a>        <span class="n">file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">)</span>
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a>        <span class="k">assert</span> <span class="n">file</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Hello"</span>
</code></pre></div>
<h4 id="parametrization">Parametrization</h4>
<p>The <code>@pytest.mark.parametrize()</code> decorator is used to define the sets of arguments to pass to the test:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>    <span class="kn">import</span> <span class="nn">pytest</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>    <span class="kn">from</span> <span class="nn">cards</span> <span class="kn">import</span> <span class="n">Card</span>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a>    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a>        <span class="s2">"start_summary, start_state"</span><span class="p">,</span> <span class="c1">#(1)</span>
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a>        <span class="p">[</span>
<a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a>            <span class="p">(</span><span class="s2">"write a book"</span><span class="p">,</span> <span class="s2">"done"</span><span class="p">),</span> <span class="c1">#(2)</span>
<a href="#__codelineno-14-8" id="__codelineno-14-8" name="__codelineno-14-8"></a>            <span class="p">(</span><span class="s2">"second edition"</span><span class="p">,</span> <span class="s2">"in prog"</span><span class="p">),</span>
<a href="#__codelineno-14-9" id="__codelineno-14-9" name="__codelineno-14-9"></a>            <span class="p">(</span><span class="s2">"create a course"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">),</span>
<a href="#__codelineno-14-10" id="__codelineno-14-10" name="__codelineno-14-10"></a>        <span class="p">],</span>
<a href="#__codelineno-14-11" id="__codelineno-14-11" name="__codelineno-14-11"></a>    <span class="p">)</span>
<a href="#__codelineno-14-12" id="__codelineno-14-12" name="__codelineno-14-12"></a>
<a href="#__codelineno-14-13" id="__codelineno-14-13" name="__codelineno-14-13"></a>    <span class="k">def</span> <span class="nf">test_finish</span><span class="p">(</span><span class="n">cards_db</span><span class="p">,</span> <span class="n">start_summary</span><span class="p">,</span> <span class="n">start_state</span><span class="p">):</span>
<a href="#__codelineno-14-14" id="__codelineno-14-14" name="__codelineno-14-14"></a>        <span class="n">initial_card</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="n">summary</span><span class="o">=</span><span class="n">start_summary</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">start_state</span><span class="p">)</span>
<a href="#__codelineno-14-15" id="__codelineno-14-15" name="__codelineno-14-15"></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">cards_db</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">initial_card</span><span class="p">)</span>
<a href="#__codelineno-14-16" id="__codelineno-14-16" name="__codelineno-14-16"></a>
<a href="#__codelineno-14-17" id="__codelineno-14-17" name="__codelineno-14-17"></a>        <span class="n">cards_db</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a href="#__codelineno-14-18" id="__codelineno-14-18" name="__codelineno-14-18"></a>
<a href="#__codelineno-14-19" id="__codelineno-14-19" name="__codelineno-14-19"></a>        <span class="n">card</span> <span class="o">=</span> <span class="n">cards_db</span><span class="o">.</span><span class="n">get_card</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a href="#__codelineno-14-20" id="__codelineno-14-20" name="__codelineno-14-20"></a>        <span class="k">assert</span> <span class="n">card</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">"done"</span>
</code></pre></div>
<ol>
<li>
<p>list of names of the parameters. It can be list of strings, comma-separated strings.</p>
</li>
<li>
<p>our list of test cases. Each element in the list is a test case represented by a tuple or list that has one element for each argument that gets sent to the test function.</p>
</li>
</ol>
<p>Result:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="gp">    $ </span>pytest -v test_func_param.py::test_finish
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="go">    ========================= test session starts ==========================</span>
<a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="go">    collected 3 items</span>
<a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a>
<a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="go">    test_func_param.py::test_finish[write a book-done] PASSED [ 33%]</span>
<a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="go">    test_func_param.py::test_finish[second edition-in prog] PASSED [ 66%]</span>
<a href="#__codelineno-15-7" id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="go">    test_func_param.py::test_finish[create a course-todo] PASSED [100%]</span>
<a href="#__codelineno-15-8" id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="go">    ========================== 3 passed in 0.05s ===========================</span>
</code></pre></div>
<p>Fixture paramentization:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">"done"</span><span class="p">,</span> <span class="s2">"in prog"</span><span class="p">,</span> <span class="s2">"todo"</span><span class="p">])</span> <span class="c1">#(1)</span>
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>    <span class="k">def</span> <span class="nf">start_state</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>        <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">param</span>
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>    <span class="k">def</span> <span class="nf">test_finish</span><span class="p">(</span><span class="n">cards_db</span><span class="p">,</span> <span class="n">start_state</span><span class="p">):</span>
<a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">Card</span><span class="p">(</span><span class="s2">"write a book"</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">start_state</span><span class="p">)</span>
<a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">cards_db</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a>        <span class="n">cards_db</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a href="#__codelineno-16-9" id="__codelineno-16-9" name="__codelineno-16-9"></a>        <span class="n">card</span> <span class="o">=</span> <span class="n">cards_db</span><span class="o">.</span><span class="n">get_card</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a href="#__codelineno-16-10" id="__codelineno-16-10" name="__codelineno-16-10"></a>        <span class="k">assert</span> <span class="n">card</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">"done"</span>
</code></pre></div>
<ol>
<li>pytest will then call the fixture once each for every set of values we provide. Then downstream, every test function that depends on the fixture will be called, once each for every fixture value.</li>
</ol>
<h3 id="mocking">Mocking</h3>
<p>The <code>mock</code> package is used to swap out pieces of the system to isolate bits of our application code from the rest of the system.</p>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: OOP" class="md-footer__link md-footer__link--prev" href="../oop/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              OOP
            </div>
</div>
</a>
<a aria-label="Next: Message Broker" class="md-footer__link md-footer__link--next" href="../message_broker/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Message Broker
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/alekseimikhalev" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/in/aleksmihalev" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.top", "navigation.prune", "navigation.indexes", "navigation.sections", "content.code.annotate", "search.suggest", "search.highlight", "content.tabs.link", "content.tooltips"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>